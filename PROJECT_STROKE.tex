% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Untitled},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Untitled}
\author{}
\date{\vspace{-2.5em}2024-09-05}

\begin{document}
\maketitle

\#\#library loading

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'caret' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## Loading required package: lattice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(nnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'nnet' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(pROC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'pROC' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## Type 'citation("pROC")' for a citation.
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'pROC'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     cov, smooth, var
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gmodels)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'gmodels' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'gmodels'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:pROC':
## 
##     ci
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(e1071)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'e1071' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(xgboost)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'xgboost' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'xgboost'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     slice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'corrplot' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## corrplot 0.94 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(imbalance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'imbalance' was built under R version 4.3.3
\end{verbatim}

\#\#importing data into

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{StrokePred }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"C:/Users/katta/Downloads/healthcare{-}dataset{-}stroke{-}data cleaned.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\#\#droping ununcessary columns

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{StrokePred[,}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}work\_type\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Residence\_type\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}smoking\_status\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}id\textquotesingle{}}\NormalTok{)] }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\#\#spliting data into train-validation and test

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}
\CommentTok{\#spliting 17\% into test dataset}
\NormalTok{sample }\OtherTok{\textless{}{-}} \FunctionTok{sample.int}\NormalTok{(}\AttributeTok{n =} \FunctionTok{nrow}\NormalTok{(StrokePred), }\AttributeTok{size =} \FunctionTok{nrow}\NormalTok{(StrokePred)}\SpecialCharTok{*}\FloatTok{0.17}\NormalTok{, }\AttributeTok{replace =}\NormalTok{ F)}
\NormalTok{strokepred\_test }\OtherTok{\textless{}{-}}\NormalTok{ StrokePred[sample, ] }\DocumentationTok{\#\#Yields held{-}out test dataset}
\NormalTok{strokepred\_trainvalidation }\OtherTok{\textless{}{-}}\NormalTok{ StrokePred[}\SpecialCharTok{{-}}\NormalTok{sample, ]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{imbalanceRatio}\NormalTok{(strokepred\_trainvalidation, }\AttributeTok{classAttr =} \StringTok{\textquotesingle{}stroke\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.04301075
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{positives }\OtherTok{\textless{}{-}} \FunctionTok{mwmote}\NormalTok{(strokepred\_trainvalidation,  }\AttributeTok{classAttr =} \StringTok{\textquotesingle{}stroke\textquotesingle{}}\NormalTok{, }\AttributeTok{numInstances =} \DecValTok{1500}\NormalTok{)}
\NormalTok{strokepred\_balanced }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(strokepred\_trainvalidation, positives)}
\FunctionTok{table}\NormalTok{(strokepred\_balanced}\SpecialCharTok{$}\NormalTok{stroke)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##    0    1 
## 3906 1668
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{imbalanceRatio}\NormalTok{(strokepred\_balanced, }\AttributeTok{classAttr =} \StringTok{\textquotesingle{}stroke\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4270353
\end{verbatim}

\hypertarget{distribution-of-age-by-gender}{%
\section{Distribution of age by
gender}\label{distribution-of-age-by-gender}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(StrokePred, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ age, }\AttributeTok{fill =}\NormalTok{ Is\_Female)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#103846"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of patients\textquotesingle{} gender"}\NormalTok{,}
       \AttributeTok{color =} \StringTok{"\#1D4B5B"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid =} \FunctionTok{element\_blank}\NormalTok{())  }\CommentTok{\# Remove gridlines}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The following aesthetics were dropped during statistical transformation: fill.
## i This can happen when ggplot fails to infer the correct grouping structure in
##   the data.
## i Did you forget to specify a `group` aesthetic or to convert a numerical
##   variable into a factor?
\end{verbatim}

\includegraphics{PROJECT_STROKE_files/figure-latex/unnamed-chunk-3-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ StrokePred, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Is\_Female, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(stroke))) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Stacked bar based on Stroke variable}
   \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Gender of patient"}\NormalTok{, }\AttributeTok{x =} \StringTok{"Is\_Female"}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#1D4B5B"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Stroke"}\NormalTok{, }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"No Stroke"}\NormalTok{, }\StringTok{"Stroke"}\NormalTok{)) }\SpecialCharTok{+}  \CommentTok{\# Legend labels}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid =} \FunctionTok{element\_blank}\NormalTok{(),  }\CommentTok{\# Remove gridlines}
        \AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{PROJECT_STROKE_files/figure-latex/unnamed-chunk-4-1.pdf}

\#\#correlation chart

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"corrplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'corrplot' is in use and will not be installed
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{corr\_data}\OtherTok{\textless{}{-}}\FunctionTok{cor}\NormalTok{(strokepred\_balanced)}
\FunctionTok{corrplot}\NormalTok{(corr\_data,}\AttributeTok{method =} \StringTok{\textquotesingle{}color\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{PROJECT_STROKE_files/figure-latex/unnamed-chunk-5-1.pdf}

\#\#spliting data into train and validation

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}
\CommentTok{\#spliting 17\% into validation dataset}
\NormalTok{sample }\OtherTok{\textless{}{-}} \FunctionTok{sample.int}\NormalTok{(}\AttributeTok{n =} \FunctionTok{nrow}\NormalTok{(strokepred\_balanced), }\AttributeTok{size =} \FunctionTok{nrow}\NormalTok{(strokepred\_balanced)}\SpecialCharTok{*}\FloatTok{0.17}\NormalTok{, }\AttributeTok{replace =}\NormalTok{ F)}
\NormalTok{strokepred\_validation }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_balanced[sample, ] }\DocumentationTok{\#\#Yields validation dataset}
\NormalTok{strokepred\_train }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_balanced[}\SpecialCharTok{{-}}\NormalTok{sample, ]}
\end{Highlighting}
\end{Shaded}

\#checking number of row for each dataset

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(strokepred\_train)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4627
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(strokepred\_validation)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 947
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(strokepred\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 834
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strokepred\_train\_scaled }\OtherTok{\textless{}{-}} \FunctionTok{scale}\NormalTok{(strokepred\_train[,}\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_train)])}
\NormalTok{strokepred\_validation\_scaled }\OtherTok{\textless{}{-}} \FunctionTok{scale}\NormalTok{(strokepred\_validation[,}\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_validation)])}
\NormalTok{strokepred\_test\_scaled }\OtherTok{\textless{}{-}} \FunctionTok{scale}\NormalTok{(strokepred\_test[,}\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_test)])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stroke\_column }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_train}\SpecialCharTok{$}\NormalTok{stroke}
\NormalTok{strokepred\_train\_scaled\_xg }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(strokepred\_train\_scaled, stroke\_column)}
\NormalTok{stroke\_column }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke}
\NormalTok{strokepred\_validation\_scaled\_xg }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(strokepred\_validation\_scaled, stroke\_column)}
\NormalTok{stroke\_column }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke}
\NormalTok{strokepred\_test\_scaled\_xg }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(strokepred\_test\_scaled, stroke\_column)}
\end{Highlighting}
\end{Shaded}

\#\#feature selection

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{control }\OtherTok{\textless{}{-}} \FunctionTok{rfeControl}\NormalTok{(}\AttributeTok{functions =}\NormalTok{ lmFuncs, }\CommentTok{\# linear regression}
                      \AttributeTok{method =} \StringTok{"repeatedcv"}\NormalTok{, }\CommentTok{\# repeated cv}
                      \AttributeTok{repeats =} \DecValTok{5}\NormalTok{, }\CommentTok{\# number of repeats}
                      \AttributeTok{number =} \DecValTok{20}\NormalTok{) }\CommentTok{\# number of folds}
\end{Highlighting}
\end{Shaded}

\hypertarget{run-recursive-feature-elimination-rfe}{%
\subsection{Run recursive feature elimination
(RFE)}\label{run-recursive-feature-elimination-rfe}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result\_rfe1 }\OtherTok{\textless{}{-}} \FunctionTok{rfe}\NormalTok{(}\AttributeTok{x =}\NormalTok{ strokepred\_train\_scaled, }
                   \AttributeTok{y =}\NormalTok{ strokepred\_train}\SpecialCharTok{$}\NormalTok{stroke, }
                   \AttributeTok{sizes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{14}\NormalTok{),}
                   \AttributeTok{rfeControl =}\NormalTok{ control)}


\NormalTok{result\_rfe1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Recursive feature selection
## 
## Outer resampling method: Cross-Validated (20 fold, repeated 5 times) 
## 
## Resampling performance over subset size:
## 
##  Variables   RMSE Rsquared    MAE   RMSESD RsquaredSD   MAESD Selected
##          1 0.3810   0.3077 0.3321 0.009503    0.04056 0.01066         
##          2 0.3742   0.3323 0.3163 0.010025    0.04435 0.01117         
##          3 0.3519   0.4086 0.2861 0.012328    0.04619 0.01174         
##          4 0.3183   0.5155 0.2466 0.013411    0.04020 0.01182         
##          5 0.3140   0.5284 0.2437 0.014050    0.04060 0.01198         
##          6 0.3111   0.5370 0.2399 0.014773    0.04178 0.01206         
##          7 0.3085   0.5448 0.2390 0.014570    0.04122 0.01186         
##          8 0.3068   0.5498 0.2374 0.014419    0.04090 0.01180         
##          9 0.3059   0.5524 0.2368 0.014891    0.04167 0.01201         
##         10 0.3059   0.5524 0.2364 0.014862    0.04195 0.01198         
##         11 0.3048   0.5556 0.2356 0.014971    0.04215 0.01208         
##         12 0.3045   0.5564 0.2353 0.014958    0.04224 0.01211         
##         13 0.3041   0.5577 0.2347 0.015046    0.04246 0.01219        *
##         14 0.3041   0.5577 0.2347 0.015040    0.04247 0.01218         
## 
## The top 5 variables (out of 13):
##    age, Is_Private, Is_Self.employed, Is_Govt_job, avg_glucose_level
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print the selected features}
\FunctionTok{predictors}\NormalTok{(result\_rfe1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "age"               "Is_Private"        "Is_Self.employed" 
##  [4] "Is_Govt_job"       "avg_glucose_level" "ever_married"     
##  [7] "Is_Female"         "formerly.smoked"   "heart_disease"    
## [10] "hypertension"      "smokes"            "Is_Urban"         
## [13] "Is_Never_worked"
\end{verbatim}

\#\#Running Logestic Regression Model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logistic\_regression\_model }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(stroke }\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{strokepred\_train, }\AttributeTok{family=}\StringTok{"binomial"}\NormalTok{) }\DocumentationTok{\#\#Or, can use all predictors except one using the \textasciitilde{} . {-}EXCLUDEDVARIABLE notation}
\FunctionTok{summary}\NormalTok{(logistic\_regression\_model) }\DocumentationTok{\#\#Outputs summary of model \& coefficients}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = stroke ~ ., family = "binomial", data = strokepred_train)
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(>|z|)    
## (Intercept)       -4.666e+00  3.159e-01 -14.770  < 2e-16 ***
## Is_Female         -1.017e+00  1.091e-01  -9.321  < 2e-16 ***
## age                1.256e-01  4.431e-03  28.336  < 2e-16 ***
## hypertension      -4.042e-01  1.564e-01  -2.585  0.00975 ** 
## heart_disease     -8.483e-01  1.822e-01  -4.656 3.22e-06 ***
## ever_married      -7.544e-01  1.602e-01  -4.709 2.49e-06 ***
## Is_Govt_job       -4.612e+00  2.860e-01 -16.128  < 2e-16 ***
## Is_Never_worked   -1.343e+01  3.412e+02  -0.039  0.96859    
## Is_Private        -3.879e+00  2.368e-01 -16.383  < 2e-16 ***
## Is_Self.employed  -4.909e+00  2.702e-01 -18.170  < 2e-16 ***
## Is_Urban          -3.005e-01  1.063e-01  -2.826  0.00472 ** 
## avg_glucose_level  8.500e-03  9.776e-04   8.694  < 2e-16 ***
## bmi                9.072e-03  8.939e-03   1.015  0.31013    
## formerly.smoked   -8.600e-01  1.453e-01  -5.920 3.23e-09 ***
## smokes            -5.483e-01  1.788e-01  -3.066  0.00217 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 5634.0  on 4626  degrees of freedom
## Residual deviance: 2372.1  on 4612  degrees of freedom
## AIC: 2402.1
## 
## Number of Fisher Scoring iterations: 14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#predicting for training data set}
\NormalTok{TRAINING\_PREDICTIONS }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(logistic\_regression\_model, }\AttributeTok{newdata=}\NormalTok{strokepred\_train,}\AttributeTok{type=}\StringTok{"response"}\NormalTok{)}
\NormalTok{strokepred\_train}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED }\OtherTok{=}\NormalTok{ TRAINING\_PREDICTIONS}

\CommentTok{\#predicting for validation data set}
\NormalTok{VALIDATION\_PREDICTIONS }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(logistic\_regression\_model, }\AttributeTok{newdata=}\NormalTok{strokepred\_validation,}\AttributeTok{type=}\StringTok{"response"}\NormalTok{)}
\NormalTok{strokepred\_validation}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED }\OtherTok{=}\NormalTok{ VALIDATION\_PREDICTIONS}

\CommentTok{\#predicting for testing data set}
\NormalTok{TEST\_PREDICTIONS }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(logistic\_regression\_model, }\AttributeTok{newdata=}\NormalTok{strokepred\_test,}\AttributeTok{type=}\StringTok{"response"}\NormalTok{)}
\NormalTok{strokepred\_test}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED }\OtherTok{=}\NormalTok{ TEST\_PREDICTIONS}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#8. Evaluate validation \& test predictions}
\FunctionTok{postResample}\NormalTok{(}\AttributeTok{pred =}\NormalTok{ VALIDATION\_PREDICTIONS, }\AttributeTok{obs =}
\NormalTok{strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      RMSE  Rsquared       MAE 
## 0.2578320 0.6904355 0.1386886
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{postResample}\NormalTok{(}\AttributeTok{pred =}\NormalTok{ TEST\_PREDICTIONS, }\AttributeTok{obs =}\NormalTok{ strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       RMSE   Rsquared        MAE 
## 0.27168688 0.05980218 0.14542971
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#training}
\NormalTok{myroc }\OtherTok{\textless{}{-}} \FunctionTok{roc}\NormalTok{(strokepred\_train}\SpecialCharTok{$}\NormalTok{stroke, strokepred\_train}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Setting levels: control = 0, case = 1
\end{verbatim}

\begin{verbatim}
## Setting direction: controls < cases
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{auc}\NormalTok{(myroc) }\DocumentationTok{\#\#Print out AUC of training}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Area under the curve: 0.947
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#validation}
\NormalTok{myroc }\OtherTok{\textless{}{-}} \FunctionTok{roc}\NormalTok{(strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke, strokepred\_validation}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Setting levels: control = 0, case = 1
## Setting direction: controls < cases
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{auc}\NormalTok{(myroc) }\DocumentationTok{\#\#Print out AUC of validation}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Area under the curve: 0.9633
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#test}
\NormalTok{myroc }\OtherTok{\textless{}{-}} \FunctionTok{roc}\NormalTok{(strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke, strokepred\_test}\SpecialCharTok{$}\NormalTok{LOGIT\_PRED)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Setting levels: control = 0, case = 1
## Setting direction: controls < cases
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{auc}\NormalTok{(myroc) }\DocumentationTok{\#\#Print out AUC of test}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Area under the curve: 0.7816
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strokepred\_validation }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_validation }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{LOGIT\_CLASSIFICATION =} \DecValTok{1}\SpecialCharTok{*}\NormalTok{(LOGIT\_PRED }\SpecialCharTok{\textgreater{}=} \FloatTok{0.5}\NormalTok{))}

\NormalTok{strokepred\_test }\OtherTok{\textless{}{-}}\NormalTok{ strokepred\_test }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{LOGIT\_CLASSIFICATION =} \DecValTok{1}\SpecialCharTok{*}\NormalTok{(LOGIT\_PRED }\SpecialCharTok{\textgreater{}=} \FloatTok{0.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{validation\_performance }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data=}\FunctionTok{as.factor}\NormalTok{(strokepred\_validation}\SpecialCharTok{$}\NormalTok{LOGIT\_CLASSIFICATION), }\AttributeTok{reference =} \FunctionTok{as.factor}\NormalTok{(strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke),}\AttributeTok{positive=}\StringTok{"1"}\NormalTok{) }\DocumentationTok{\#\#Generate confusion matrix (based on probability cutoff)}
\NormalTok{validation\_performance}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 630  58
##          1  26 233
##                                           
##                Accuracy : 0.9113          
##                  95% CI : (0.8914, 0.9286)
##     No Information Rate : 0.6927          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.7851          
##                                           
##  Mcnemar's Test P-Value : 0.0007186       
##                                           
##             Sensitivity : 0.8007          
##             Specificity : 0.9604          
##          Pos Pred Value : 0.8996          
##          Neg Pred Value : 0.9157          
##              Prevalence : 0.3073          
##          Detection Rate : 0.2460          
##    Detection Prevalence : 0.2735          
##       Balanced Accuracy : 0.8805          
##                                           
##        'Positive' Class : 1               
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test\_performance }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data=}\FunctionTok{as.factor}\NormalTok{(strokepred\_test}\SpecialCharTok{$}\NormalTok{LOGIT\_CLASSIFICATION), }\AttributeTok{reference =} \FunctionTok{as.factor}\NormalTok{(strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke),}\AttributeTok{positive=}\StringTok{"1"}\NormalTok{) }\DocumentationTok{\#\#Generate confusion matrix (based on probability cutoff)}
\NormalTok{test\_performance}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 737  25
##          1  56  16
##                                           
##                Accuracy : 0.9029          
##                  95% CI : (0.8807, 0.9221)
##     No Information Rate : 0.9508          
##     P-Value [Acc > NIR] : 1.0000000       
##                                           
##                   Kappa : 0.2353          
##                                           
##  Mcnemar's Test P-Value : 0.0008581       
##                                           
##             Sensitivity : 0.39024         
##             Specificity : 0.92938         
##          Pos Pred Value : 0.22222         
##          Neg Pred Value : 0.96719         
##              Prevalence : 0.04916         
##          Detection Rate : 0.01918         
##    Detection Prevalence : 0.08633         
##       Balanced Accuracy : 0.65981         
##                                           
##        'Positive' Class : 1               
## 
\end{verbatim}

\#\#Running a SVM model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{svm}\NormalTok{(strokepred\_train\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_train\_scaled\_xg)], }
             \AttributeTok{kernel =} \StringTok{"radial"}\NormalTok{, }\AttributeTok{cost =} \DecValTok{1000}\NormalTok{, }\AttributeTok{gamma =} \FloatTok{0.1}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Predict on validation data}
\NormalTok{validation\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model, strokepred\_validation\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_validation\_scaled\_xg)])}



\CommentTok{\# Predict on test data}
\NormalTok{test\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model, strokepred\_test\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_test\_scaled\_xg)])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{validation\_pred\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(validation\_pred }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{test\_pred\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(test\_pred }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Validation Confusion Matrix}


\NormalTok{strokepred\_validation\_scaled}\SpecialCharTok{$}\NormalTok{preds }\OtherTok{=}\NormalTok{ validation\_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in strokepred_validation_scaled$preds = validation_pred: Coercing LHS
## to a list
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strokepred\_validation\_scaled}\SpecialCharTok{$}\NormalTok{preds }\OtherTok{\textless{}{-}} \FunctionTok{as.integer}\NormalTok{(}\FunctionTok{as.logical}\NormalTok{(strokepred\_validation\_scaled}\SpecialCharTok{$}\NormalTok{preds))}
\CommentTok{\# Generate confusion matrix}

\NormalTok{validation\_pred\_factor }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(strokepred\_validation\_scaled}\SpecialCharTok{$}\NormalTok{preds, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\CommentTok{\# Assuming true labels are numeric (0/1)}
\NormalTok{strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke\_factor }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\CommentTok{\# Generate confusion matrix}
\NormalTok{validation\_performance }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data =}\NormalTok{ validation\_pred\_factor, }\AttributeTok{reference =}\NormalTok{ strokepred\_validation}\SpecialCharTok{$}\NormalTok{stroke\_factor, }\AttributeTok{positive =} \StringTok{"1"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(validation\_performance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 331 138
##          1 325 153
##                                           
##                Accuracy : 0.5111          
##                  95% CI : (0.4787, 0.5434)
##     No Information Rate : 0.6927          
##     P-Value [Acc > NIR] : 1               
##                                           
##                   Kappa : 0.0257          
##                                           
##  Mcnemar's Test P-Value : <2e-16          
##                                           
##             Sensitivity : 0.5258          
##             Specificity : 0.5046          
##          Pos Pred Value : 0.3201          
##          Neg Pred Value : 0.7058          
##              Prevalence : 0.3073          
##          Detection Rate : 0.1616          
##    Detection Prevalence : 0.5048          
##       Balanced Accuracy : 0.5152          
##                                           
##        'Positive' Class : 1               
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Test Confusion Matrix}


\NormalTok{strokepred\_test\_scaled}\SpecialCharTok{$}\NormalTok{preds }\OtherTok{=}\NormalTok{ test\_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in strokepred_test_scaled$preds = test_pred: Coercing LHS to a list
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strokepred\_test\_scaled}\SpecialCharTok{$}\NormalTok{preds }\OtherTok{\textless{}{-}} \FunctionTok{as.integer}\NormalTok{(}\FunctionTok{as.logical}\NormalTok{(strokepred\_test\_scaled}\SpecialCharTok{$}\NormalTok{preds))}
\CommentTok{\# Generate confusion matrix}

\NormalTok{test\_pred\_factor }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(strokepred\_test\_scaled}\SpecialCharTok{$}\NormalTok{preds, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\CommentTok{\# Assuming true labels are numeric (0/1)}
\NormalTok{strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke\_factor }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\CommentTok{\# Generate confusion matrix}
\NormalTok{test\_performance }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(}\AttributeTok{data =}\NormalTok{ test\_pred\_factor, }\AttributeTok{reference =}\NormalTok{ strokepred\_test}\SpecialCharTok{$}\NormalTok{stroke\_factor, }\AttributeTok{positive =} \StringTok{"1"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(test\_performance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 346  27
##          1 447  14
##                                           
##                Accuracy : 0.4317          
##                  95% CI : (0.3977, 0.4661)
##     No Information Rate : 0.9508          
##     P-Value [Acc > NIR] : 1               
##                                           
##                   Kappa : -0.0379         
##                                           
##  Mcnemar's Test P-Value : <2e-16          
##                                           
##             Sensitivity : 0.34146         
##             Specificity : 0.43632         
##          Pos Pred Value : 0.03037         
##          Neg Pred Value : 0.92761         
##              Prevalence : 0.04916         
##          Detection Rate : 0.01679         
##    Detection Prevalence : 0.55276         
##       Balanced Accuracy : 0.38889         
##                                           
##        'Positive' Class : 1               
## 
\end{verbatim}

\#\#Running XGBoost Model

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create DMatrix objects for XGBoost}

\NormalTok{dtrain }\OtherTok{\textless{}{-}} \FunctionTok{xgb.DMatrix}\NormalTok{(}\AttributeTok{data =} \FunctionTok{as.matrix}\NormalTok{(strokepred\_train\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_train\_scaled\_xg)]), }\AttributeTok{label =}\NormalTok{ strokepred\_train\_scaled\_xg[, }\FunctionTok{ncol}\NormalTok{(strokepred\_train\_scaled\_xg)])}
\NormalTok{dvalidation }\OtherTok{\textless{}{-}} \FunctionTok{xgb.DMatrix}\NormalTok{(}\AttributeTok{data =} \FunctionTok{as.matrix}\NormalTok{(strokepred\_validation\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_validation\_scaled\_xg)]), }\AttributeTok{label =}\NormalTok{ strokepred\_validation\_scaled\_xg[, }\FunctionTok{ncol}\NormalTok{(strokepred\_validation\_scaled\_xg)])}
\NormalTok{dtest }\OtherTok{\textless{}{-}} \FunctionTok{xgb.DMatrix}\NormalTok{(}\AttributeTok{data =} \FunctionTok{as.matrix}\NormalTok{(strokepred\_test\_scaled\_xg[, }\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(strokepred\_test\_scaled\_xg)]), }\AttributeTok{label =}\NormalTok{ strokepred\_test\_scaled\_xg[, }\FunctionTok{ncol}\NormalTok{(strokepred\_test\_scaled\_xg)])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{params }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{booster =} \StringTok{"gbtree"}\NormalTok{,}
  \AttributeTok{objective =} \StringTok{"binary:logistic"}\NormalTok{,  }\CommentTok{\# For classification}
  \AttributeTok{eval\_metric =} \StringTok{"error"}\NormalTok{,  }\CommentTok{\# Evaluation metric}
  \AttributeTok{max\_depth =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{eta =} \FloatTok{0.1}\NormalTok{,}
  \AttributeTok{nrounds =} \DecValTok{100}
\NormalTok{)}

\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{xgboost}\NormalTok{(}\AttributeTok{params =}\NormalTok{ params, }\AttributeTok{data =}\NormalTok{ dtrain, }\AttributeTok{nrounds =}\NormalTok{ params}\SpecialCharTok{$}\NormalTok{nrounds)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [00:31:00] WARNING: src/learner.cc:767: 
## Parameters: { "nrounds" } are not used.
## 
## [1]  train-error:0.164469 
## [2]  train-error:0.165550 
## [3]  train-error:0.152799 
## [4]  train-error:0.146099 
## [5]  train-error:0.148260 
## [6]  train-error:0.143289 
## [7]  train-error:0.143506 
## [8]  train-error:0.135725 
## [9]  train-error:0.135293 
## [10] train-error:0.129025 
## [11] train-error:0.131619 
## [12] train-error:0.137238 
## [13] train-error:0.130106 
## [14] train-error:0.129890 
## [15] train-error:0.126864 
## [16] train-error:0.124487 
## [17] train-error:0.121893 
## [18] train-error:0.121245 
## [19] train-error:0.120164 
## [20] train-error:0.121029 
## [21] train-error:0.119516 
## [22] train-error:0.116706 
## [23] train-error:0.119732 
## [24] train-error:0.115626 
## [25] train-error:0.117355 
## [26] train-error:0.115626 
## [27] train-error:0.114113 
## [28] train-error:0.114113 
## [29] train-error:0.113897 
## [30] train-error:0.110871 
## [31] train-error:0.112168 
## [32] train-error:0.110439 
## [33] train-error:0.105900 
## [34] train-error:0.105900 
## [35] train-error:0.102658 
## [36] train-error:0.103523 
## [37] train-error:0.102658 
## [38] train-error:0.102226 
## [39] train-error:0.101578 
## [40] train-error:0.101145 
## [41] train-error:0.100281 
## [42] train-error:0.100281 
## [43] train-error:0.100497 
## [44] train-error:0.100065 
## [45] train-error:0.097687 
## [46] train-error:0.098336 
## [47] train-error:0.097471 
## [48] train-error:0.097904 
## [49] train-error:0.098552 
## [50] train-error:0.098984 
## [51] train-error:0.098768 
## [52] train-error:0.097471 
## [53] train-error:0.097471 
## [54] train-error:0.095742 
## [55] train-error:0.095742 
## [56] train-error:0.097039 
## [57] train-error:0.096607 
## [58] train-error:0.095959 
## [59] train-error:0.096175 
## [60] train-error:0.095094 
## [61] train-error:0.095310 
## [62] train-error:0.094878 
## [63] train-error:0.094662 
## [64] train-error:0.093797 
## [65] train-error:0.093797 
## [66] train-error:0.092284 
## [67] train-error:0.092284 
## [68] train-error:0.093149 
## [69] train-error:0.092284 
## [70] train-error:0.092284 
## [71] train-error:0.092068 
## [72] train-error:0.092068 
## [73] train-error:0.092068 
## [74] train-error:0.090123 
## [75] train-error:0.090772 
## [76] train-error:0.090555 
## [77] train-error:0.090123 
## [78] train-error:0.090339 
## [79] train-error:0.090555 
## [80] train-error:0.090339 
## [81] train-error:0.089907 
## [82] train-error:0.089259 
## [83] train-error:0.089691 
## [84] train-error:0.089259 
## [85] train-error:0.088178 
## [86] train-error:0.087746 
## [87] train-error:0.087746 
## [88] train-error:0.086017 
## [89] train-error:0.087962 
## [90] train-error:0.084936 
## [91] train-error:0.084288 
## [92] train-error:0.082991 
## [93] train-error:0.082991 
## [94] train-error:0.082559 
## [95] train-error:0.082559 
## [96] train-error:0.083207 
## [97] train-error:0.082775 
## [98] train-error:0.081046 
## [99] train-error:0.080614 
## [100]    train-error:0.080398
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make predictions on validation and test data}
\NormalTok{validation\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model, dvalidation)}
\NormalTok{test\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model, dtest)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{thresholds }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.9}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.1}\NormalTok{)}
\NormalTok{best\_threshold }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\NormalTok{best\_f1\_score }\OtherTok{\textless{}{-}} \DecValTok{0}

\ControlFlowTok{for}\NormalTok{ (threshold }\ControlFlowTok{in}\NormalTok{ thresholds) \{}
\NormalTok{  validation\_pred\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(validation\_pred }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{  validation\_cm }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ strokepred\_validation\_scaled\_xg[, }\FunctionTok{ncol}\NormalTok{(strokepred\_validation\_scaled\_xg)], }\AttributeTok{predicted =}\NormalTok{ validation\_pred\_numeric)}
\NormalTok{  validation\_precision }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(validation\_cm[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(validation\_cm[, }\DecValTok{1}\NormalTok{])}
\NormalTok{  validation\_recall }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(validation\_cm[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(validation\_cm[}\DecValTok{2}\NormalTok{, ])}
\NormalTok{  validation\_f1\_score }\OtherTok{\textless{}{-}} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ validation\_precision }\SpecialCharTok{*}\NormalTok{ validation\_recall }\SpecialCharTok{/}\NormalTok{ (validation\_precision }\SpecialCharTok{+}\NormalTok{ validation\_recall)}

  \ControlFlowTok{if}\NormalTok{ (validation\_f1\_score }\SpecialCharTok{\textgreater{}}\NormalTok{ best\_f1\_score) \{}
\NormalTok{    best\_threshold }\OtherTok{\textless{}{-}}\NormalTok{ threshold}
\NormalTok{    best\_f1\_score }\OtherTok{\textless{}{-}}\NormalTok{ validation\_f1\_score}
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Best threshold:"}\NormalTok{, best\_threshold, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Best threshold: 0.1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ... (rest of your code)}

\CommentTok{\# Apply the optimal threshold to the test predictions}
\NormalTok{test\_pred\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(test\_pred }\SpecialCharTok{\textgreater{}} \FloatTok{0.1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\CommentTok{\# Calculate the confusion matrix and other metrics}
\NormalTok{test\_cm }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ strokepred\_test\_scaled\_xg[, }\FunctionTok{ncol}\NormalTok{(strokepred\_test\_scaled\_xg)], }\AttributeTok{predicted =}\NormalTok{ test\_pred\_numeric)}
\NormalTok{test\_accuracy }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(test\_cm)) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(test\_cm)}
\NormalTok{test\_recall }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(test\_cm[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(test\_cm[}\DecValTok{2}\NormalTok{, ])}
\NormalTok{test\_precision }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(test\_cm[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(test\_cm[, }\DecValTok{1}\NormalTok{])}
\NormalTok{test\_f1\_score }\OtherTok{\textless{}{-}} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ test\_precision }\SpecialCharTok{*}\NormalTok{ test\_recall }\SpecialCharTok{/}\NormalTok{ (test\_precision }\SpecialCharTok{+}\NormalTok{ test\_recall)}

\CommentTok{\# Print results}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Test accuracy:"}\NormalTok{, test\_accuracy, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Test accuracy: 0.5539568
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Test recall:"}\NormalTok{, test\_recall, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Test recall: 0.8536585
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Test precision:"}\NormalTok{, test\_precision, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Test precision: 0.9861432
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Test F1{-}score:"}\NormalTok{, test\_f1\_score, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Test F1-score: 0.9151307
\end{verbatim}

\end{document}
